<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>Improving Tableau's Document API</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css">
    <link rel="stylesheet" href="./theme/css/main.6e96f7d8.css">
  <style media="print">.is-hidden-print{display:none !important}</style>
      <link rel="stylesheet" href="./custom.css">
<meta property="og:title" content="Just Numbers & Things - Improving Tableau's Document API">
  <meta property="og:description" content="Improving Tableau's Document API">
<meta property="og:url" content="./2017-06-04-Improving-Tableau-Document-API.html">
<meta name="twitter:card" content="summary">
<meta property="og:site_name" content="Just Numbers & Things">
<meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-06-04T00:00:00-07:00">
    <meta property="article:tag" content="Tableau">
    <meta property="article:tag" content="Python">
  <meta property="article:section" content="Tinkerer">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="nav">
        <div class="nav-left">
          <a class="nav-item is-brand title is-3"
             href="./">Just Numbers & Things</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="nav has-shadow is-hidden-print">
  <div class="container">
    <div class="nav-center"></div>
    <span id="navToggle" class="nav-toggle">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="nav-right nav-menu">
          <a class="nav-item is-tab is-active"
             href="./category/tinkerer.html">Tinkerer</a>
          <a class="nav-item is-tab "
             href="./category/analyst.html">Analyst</a>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
<section id="content" class="body">
  <article>
    <h1 class="title">
      <a href="./2017-06-04-Improving-Tableau-Document-API.html" rel="bookmark"
         title="Permalink to Improving Tableau's Document API">Improving Tableau's Document API</a></h1>
<footer class="post-info">
  <abbr class="published" title="2017-06-04T00:00:00-07:00">
    Published <span class="is-info">Sun 04 June 2017</span>
    in <a href="./category/tinkerer.html">Tinkerer</a>
  </abbr>

    <p class="author">
      <em>by           <a class="url fn" href="./author/r-richmond.html">r-richmond</a>
</em>
      <span class="tag is-small"><a href="./tag/tableau.html">Tableau</a></span>
      <span class="tag is-small"><a href="./tag/python.html">Python</a></span>
    </p>
  
</footer>    <div class="section"><h1>1) What is Tableau's Document API?</h1>
<p>With the release of Tableau 10, Tableau released a <a href="https://github.com/tableau/document-api-python">python utility</a> called the Tableau Document API (or TDA for short). TDA allows users to easily programmatically modify tableau workbooks. Modifying tableau workbooks without using Tableau Desktop was possible before as tableau files <code>.twb</code> are actually just xml files. However manually editing the xml of <code>.twb</code> files could easily result in an unusable corrupted workbook. Fortunately with the release of this tool it is now much simpler to modify workbooks without using Tableau Desktop.</p>
<h1>2) Using Tableau's Document API</h1>
<p>TDA is written in Python so using it is as simple as <code>pip install TableauDocumentApi</code> and <code>import TableauDocumentApi</code>. For example if you needed to update the connection strings in a dozen local tableau files you could use the following script to update them all.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">TableauDocumentApi</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;my_folder&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.twb&quot;</span><span class="p">):</span>
  <span class="n">tableau_workbook</span> <span class="o">=</span> <span class="n">tda</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">datasource</span> <span class="ow">in</span> <span class="n">tableau_workbook</span><span class="o">.</span><span class="n">datasources</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">connection</span> <span class="ow">in</span> <span class="n">datasource</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
      <span class="n">connection</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="s1">&#39;my-new-host&#39;</span>
<span class="n">tableau_workbook</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>


<h1>3) Tableau's Query Bands &amp; Initial SQL</h1>
<p>Taking a step away from TDA for a moment Tableau has two less visible but still immensely useful features: <a href="http://onlinehelp.tableau.com/current/pro/desktop/en-us/examples_teradata.html#initial_sql">Initial SQL</a> &amp; <a href="http://onlinehelp.tableau.com/current/pro/desktop/en-us/examples_teradata.html#query_band">querybands</a>. I've personally used these features to stage temporary tables &amp; tag each query(There are so many...) that tableau runs.</p>
<h1>4) How does this relate to the TableauDocumentAPI</h1>
<p>The <a href="https://github.com/t8y8/document-api-python/blob/3a38058f168e29874dc95af4f697888bba71a4fe/tableaudocumentapi/connection.py">first version I used of Tableau's Document API</a> did not support modifying initial sql &amp; query bands. After being faced with modifying 1,000+ workbooks to use query bands I decided to review the library and see if support could be easily added. Glancing at the source code I could see that each of the properties of a connection was cleanly defined. Using Port as an example I was able to submit a <a href="https://github.com/tableau/document-api-python/pull/123">pull request</a> implementing the functionality. Fortunately, the Tableau team was very responsive and quickly merged the pull request.</p>
<h1>5) Tying it all together</h1>
<p>So now if you find yourself in a situation where you need to modify the query bands or the initial sql in your workbooks you can use the TDA to save yourself some time.</p>
<p>Cheers!</p></div>
    <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'justnumbersandthings';
        var disqus_identifier = '2017-06-04-Improving-Tableau-Document-API.html';
        var disqus_url = './2017-06-04-Improving-Tableau-Document-API.html';
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//justnumbersandthings.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>

  </article>
</section>

<script type="application/ld+json">
  {"articleSection": "Tinkerer", "author": {"@type": "Person", "name": "r-richmond"}, "datePublished": "2017-06-04T00:00:00-07:00", "headline": "Improving Tableau's Document API", "mainEntityOfPage": {"@type": "WebPage", "@id": "./2017-06-04-Improving-Tableau-Document-API.html"}, "@context": "http://schema.org", "@type": "BlogPosting", "description": "Improving Tableau's Document API"}
</script>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
          <p class="menu-label">Other Pages</p>
          <ul class="menu-list">
                <li><a                        href="./pages/About.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">About</span>
                </a></li>
          </ul>
          <p class="menu-label">Links</p>
          <ul class="menu-list">
              <li><a href="http://getpelican.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Pelican</span>
              </a></li>
              <li><a href="http://python.org/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Python.org</span>
              </a></li>
              <li><a href="https://news.ycombinator.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Hacker News</span>
              </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="https://github.com/r-richmond">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text">Github</span>
    </a></li>
</ul>      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
 <p class="subtitle">A place for thoughts</p>    <p><a href="https://github.com/textbook/bulrush">Bulrush</a> theme for
        <a href="https://blog.getpelican.com/">Pelican</a>
      | <span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5
      | <span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3
    </p>
  </div>
</footer>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-96235563-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = 'https://ssl.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'justnumbersandthings';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'nav-right nav-menu') {
      nav.className = 'nav-right nav-menu is-active';
    } else {
      nav.className = 'nav-right nav-menu';
    }
  });
</script>
</body>
</html>